<nb-card>
    <nb-card-header>
        Tìm kiếm
    </nb-card-header>
    <nb-card-body>
        <div class="row">
            <div class="col-md-12 col-lg-3 col-xxxl-3">
                <nb-alert class="box_alert m-0" status="primary"> Tổng số<span class="report_nb text-right w-100 pr-4">3</span> </nb-alert>
            </div>
            <div class="col-md-12 col-lg-3 col-xxxl-3">
                <nb-alert class="box_alert m-0" status="success">Mới tạo<span class="report_nb text-right w-100 pr-4">3</span></nb-alert>
            </div>
            <div class="col-md-12 col-lg-3 col-xxxl-3">
                <nb-alert class="box_alert m-0" status="info">Chăm sóc thành công<span class="report_nb text-right w-100 pr-4">3</span></nb-alert>
            </div>
            <div class="col-md-12 col-lg-3 col-xxxl-3">
                <nb-alert class="box_alert m-0" status="warning">Chăm sóc không thành công<span class="report_nb text-right w-100 pr-4">3</span></nb-alert>
            </div>
        </div>
    </nb-card-body>
    <div *ngIf="!isChild">
        <nb-card-body>
            <div class="row">
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Từ khóa</div>
                        <div class="col-md-12 col-lg-12">
                            <input type="text" nbInput class="m-input form-control" [(ngModel)]="modelSearch.filter" />
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Loại khách hàng</div>
                        <div class="col-md-12 col-lg-12">
                            <ngx-cagt-select 
                                [modeOfDropDowList]="dropdownListEnum.LOAI_KHACH_HANG" 
                                [isMulti]="true"
                                [selected]="modelSearch.loaiKhachHangs" 
                                [(ngModel)]="modelSearch.loaiKhachHangs">
                            </ngx-cagt-select>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Thời gian từ</div>
                        <div class="col-md-12 col-lg-12">
                            <input type="date" nbInput class="m-input form-control mr-2" [(ngModel)]="modelSearch.thoiGianTu" />
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Thời gian đến</div>
                        <div class="col-md-12 col-lg-12">
                            <input type="date" nbInput class="m-input form-control mr-2" [(ngModel)]="modelSearch.thoiGianDen" />
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Nguồn khách hàng</div>
                        <div class="col-md-12 col-lg-12">
                            <ngx-cagt-select 
                                [modeOfDropDowList]="dropdownListEnum.NGUON_KHACH_HANG" 
                                [isMulti]="true"
                                [(ngModel)]="modelSearch.nguonKhachHangs">
                            </ngx-cagt-select>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Loại khách hàng</div>
                        <div class="col-md-12 col-lg-12">
                            <ngx-cagt-select 
                                [modeOfDropDowList]="dropdownListEnum.LOAI_KHACH_HANG" 
                                [isMulti]="true"
                                [(ngModel)]="modelSearch.loaiKhachHangs">
                            </ngx-cagt-select>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Người phụ trách</div>
                        <div class="col-md-12 col-lg-12">
                            <ngx-cagt-select 
                                [modeOfDropDowList]="dropdownListEnum.NHAN_VIEN_PHU_TRACH" 
                                [isMulti]="true"
                                [(ngModel)]="modelSearch.nguoiPhuTrachs">
                            </ngx-cagt-select>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-lg-3 col-xxxl-3 ">
                    <div class="row">
                        <div class="col-md-12 col-lg-12 pb-1">Trạng thái khách hàng</div>
                        <div class="col-md-12 col-lg-12">
                            <ngx-cagt-select 
                                [modeOfDropDowList]="dropdownListEnum.TRANG_THAI_KHACH_HANG" 
                                [isMulti]="true"
                                [(ngModel)]="modelSearch.trangThaiKhachHangs">
                            </ngx-cagt-select>
                        </div>
                    </div>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-12 col-lg-12">
                    <div class="col-md-6 offset-md-3 text-center">
                        <button class="mr-2" nbButton status="primary" size="medium" (click)="onSearchChange()"> 
                            <i class="fa fa-search mr-2"></i> Tìm kiếm
                        </button>
                        <button class="mr-2" nbButton status="warning" size="medium" (click)="resetHandler()">
                            <i class="fas fa-redo-alt mr-2"></i> Làm mới
                        </button>
                    </div>
                </div>
            </div>
        </nb-card-body>
    </div>
</nb-card>


<nb-card>
    <nb-card-header>
        Chăm sóc khách hàng
    </nb-card-header>
    <nb-card-body class="group-button text-right pb-0" *ngIf="!isChild">
        <button nbButton status="primary" (click)="addHandler()">Thêm mới</button>
        <button nbButton status="danger" (click)="removeSelectedHandler()" [disabled]="selectionIds.length < 1">
            <i class="fas fa-trash-alt mr-2"></i>Xóa
        </button>
        <button nbButton status="wrapper" (click)="importHandler()"><i class="fas fa-file-upload mr-2"></i>Import</button>
        <button nbButton status="success" (click)="exportHandler()"><i class="fas fa-file-download mr-2"></i>Export</button>
    </nb-card-body>

    <nb-card-body>
        <nb-tabset>
            <nb-tab class="pl-0 pr-0" tabTitle="Tất cả">
                <kendo-grid class="kendo_custom " [data]="gridView$" [resizable]="true" [pageSize]="gridState.take" [skip]="gridState.skip" [loading]="isLoading" [pageable]="true" [resizable]="true" kendoGridSelectBy="id" [selectable]="true" [selectedKeys]="selectionIds"
                    (dataStateChange)="onStateChange($event)">
                    <kendo-grid-column title="STT" [width]="60" class="text-center" [headerStyle]="{
                        'text-align': 'center'
                      }">
                        <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                            {{ rowIndex + 1 }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="hoTen" class="kendo_title" title="Thông tin khách hàng">
                    </kendo-grid-column>
                    <kendo-grid-column field="ngaySinh" class="kendo_title" title="Ngày CSKH dự kiến">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{ dataItem.ngaySinh | date: "dd/MM/yyyy" }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="soDienThoai" class="kendo_title" title="Thông tin CSKH">
                    </kendo-grid-column>
                    <kendo-grid-column field="email" class="kendo_title" title="Phản hồi KH">
                    </kendo-grid-column>
                    <kendo-grid-column field="loaiKhachHang" class="kendo_title" title="Nhân viên phụ trách">
                    </kendo-grid-column>
                    <ng-template kendoGridDetailTemplate let-dataItem>

                        <section>
                            <div *ngIf="dataItem.hoTen != null && dataItem.hoTen != ''">

                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Họ tên </label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.hoTen }}
                                    </label>
                                </div>

                            </div>
                            <div *ngIf="dataItem.ngaySinh != null && dataItem.ngaySinh != ''">
                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Ngày sinh</label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.ngaySinh }}
                                    </label>
                                </div>


                            </div>
                            <div *ngIf="dataItem.diaChi != null && dataItem.diaChi != ''">
                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Địa chỉ</label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.diaChi }}
                                    </label>
                                </div>

                            </div>
                            <div *ngIf="dataItem.soDienThoai != null && dataItem.soDienThoai != ''">
                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Số điện thoại </label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.soDienThoai }}
                                    </label>
                                </div>

                            </div>
                            <div *ngIf="dataItem.email != null && dataItem.email != ''">
                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Email </label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.email }}
                                    </label>
                                </div>


                            </div>
                            <div *ngIf="dataItem.loaiKhachHang != null && dataItem.loaiKhachHang != ''">
                                <div class="col-md-12 col-lg-3 col-xxxl-2 float-left custom_table">
                                    <label class="col-form-label">Loại khách hàng </label>
                                    <span class="float-right">:</span>
                                </div>
                                <div class="col-md-12 col-lg-9 col-xxxl-2">
                                    <label class=" col-form-label lb-bold-info">
                                        {{ dataItem?.loaiKhachHang }}
                                    </label>
                                </div>

                            </div>
                        </section>
                    </ng-template>
                </kendo-grid>
            </nb-tab>
            <nb-tab class="pl-0 pr-0" tabTitle="Đã chăm sóc">
                <kendo-grid [data]="gridView$" [resizable]="true" [pageSize]="gridState.take" [skip]="gridState.skip" [loading]="isLoading" [pageable]="true" [resizable]="true" kendoGridSelectBy="id" [selectable]="true" [selectedKeys]="selectionIds" (dataStateChange)="onStateChange($event)">


                    <kendo-grid-column title="STT" [width]="60" class="text-center" [headerStyle]="{
                        'text-align': 'center'
                      }">
                        <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                            {{ rowIndex + 1 }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="hoTen" title="Thông tin khách hàng">
                    </kendo-grid-column>
                    <kendo-grid-column field="ngaySinh" title="Ngày CSKH dự kiến">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{ dataItem.ngaySinh | date: "dd/MM/yyyy" }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column field="soDienThoai" title="Thông tin CSKH">
                    </kendo-grid-column>
                    <kendo-grid-column field="email" title="Phản hồi KH">
                    </kendo-grid-column>
                    <kendo-grid-column field="loaiKhachHang" title="Nhân viên phụ trách">
                    </kendo-grid-column>
                    <ng-template kendoGridDetailTemplate let-dataItem>
                        <section>
                            <div class="row" *ngIf="dataItem.hoTen != null && dataItem.hoTen != ''">


                                <label class="col-md-2 col-form-label">Họ tên
                                            <span class="float-right">:</span>
                                        </label>
                                <label class="col-md-10 col-form-label lb-bold-info">
                                            {{ dataItem?.hoTen }}
                                        </label>


                            </div>
                            <div class="row" *ngIf="dataItem.ngaySinh != null && dataItem.ngaySinh != ''">
                                <div class="col-md-12">
                                    <div class="row">
                                        <label class="col-2 col-form-label">Ngày sinh
                                            <span class="float-right">:</span>
                                        </label>
                                        <label class="col-10 col-form-label lb-bold-info">
                                            {{ dataItem?.ngaySinh }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" *ngIf="dataItem.diaChi != null && dataItem.diaChi != ''">
                                <div class="col-md-12">
                                    <div class="row">
                                        <label class="col-2 col-form-label">Địa chỉ
                                            <span class="float-right">:</span>
                                        </label>
                                        <label class="col-10 col-form-label lb-bold-info">
                                            {{ dataItem?.diaChi }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" *ngIf="dataItem.soDienThoai != null && dataItem.soDienThoai != ''">
                                <div class="col-md-12">
                                    <div class="row">
                                        <label class="col-2 col-form-label">Số điện thoại
                                            <span class="float-right">:</span>
                                        </label>
                                        <label class="col-10 col-form-label lb-bold-info">
                                            {{ dataItem?.soDienThoai }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" *ngIf="dataItem.email != null && dataItem.email != ''">
                                <div class="col-md-12">
                                    <div class="row">
                                        <label class="col-2 col-form-label">Email
                                            <span class="float-right">:</span>
                                        </label>
                                        <label class="col-10 col-form-label lb-bold-info">
                                            {{ dataItem?.email }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" *ngIf="dataItem.loaiKhachHang != null && dataItem.loaiKhachHang != ''">
                                <div class="col-md-12">
                                    <div class="row">
                                        <label class="col-2 col-form-label">Loại khách hàng
                                            <span class="float-right">:</span>
                                        </label>
                                        <label class="col-10 col-form-label lb-bold-info">
                                            {{ dataItem?.loaiKhachHang }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </ng-template>
                </kendo-grid>
            </nb-tab>
            <nb-tab class="pl-0 pr-0" tabTitle="Chưa chăm sóc">
                .........
            </nb-tab>
        </nb-tabset>


        <!-- <ng2-smart-table [settings]="settings" [source]="source" (deleteConfirm)="onDeleteConfirm($event)">
        </ng2-smart-table> -->

    </nb-card-body>
</nb-card>

<div *ngIf="!isChild">
    <div class="k-overlay" *ngIf="opened"></div>
    <div class="wrapper form-layouts">
        <div kendoWindowContainer></div>
    </div>
</div>