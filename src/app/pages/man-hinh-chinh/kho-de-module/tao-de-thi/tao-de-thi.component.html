<nb-card>
    <nb-card-header>
        <div class="row">
            <div class="col-lg-6 col-md-6">
                <span>Tên đề thi</span>
                <input type="text" nbInput class="ml-2 m-input form-control" style="display: inline;"/>
            </div>
            <div class="col-lg-6 col-md-6">
                <span>Thời gian làm bài</span>
                <input type="number" nbInput class="ml-2 m-input form-control" style="display: inline;" placeholder="(phút)"/>
            </div>
        </div>
    </nb-card-header>
    <nb-card-body>
        <div class="row">
            <div class="col-lg-4 col-4">
                <nb-card>
                    <nb-card-header>
                        <div style="text-align: left;">
                            <span class="float-left">Danh sách câu hỏi</span>
                            <button nbButton status="success" size="small" (click)="addCauHoi()" class="float-right"
                                style="height: 100%;">
                                <i class="fa fa-plus mr-2"></i>Thêm câu hỏi
                            </button>
                        </div>
                    </nb-card-header>
                    <div class="mt-2 mb-2">
                        <cdk-virtual-scroll-viewport  style="height: 710px" itemSize="90" >
                            <kendo-treeview 
                                [resizable]="true" 
                                kendoTreeViewDragAndDrop kendoTreeViewDragAndDropEditing
                                kendoTreeViewHierarchyBinding 
                                [childrenField]="'items'" 
                                [nodes]="dataCauHoi"
                                [textField]="'tenCauHoi'" 
                                kendoTreeViewExpandable [expandBy]="'id'"
                                [expandedKeys]="expandedKeys"
                                ng-click="selectCauHoi($event)"
                                >
                                <ng-template kendoTreeViewNodeTemplate let-dataItem>
                                    <div class="row" style="width: 100%;" (click)="showCauHoi(dataItem)">
                                        <div class="col-lg-8">
                                            <input type="text" nbInput class="m-input form-control"
                                                [(ngModel)]="dataItem.tenCauHoi" />
                                        </div>
                                        <div class="col-lg-4">
                                            <button nbButton status="danger" size="small" (click)="removeCauHoi(dataCauHoi,dataItem)"
                                                class="mr-1" style="height: 100%;"
                                                *ngIf="dataItem != dataCauHoi[0]"
                                                >
                                                <i class="fa fa-trash"></i>
                                            </button>
                                            <button nbButton status="success" size="small" (click)="addCauHoi()" class="mr-1"
                                                style="height: 100%;">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </ng-template>
                            </kendo-treeview>
                        </cdk-virtual-scroll-viewport>
                    </div>
                </nb-card>
            </div>
            <div class="col-lg-8 col-8">
                <div *ngIf="selectedCauHoi != null && dataCauHoi.length > 0">
                    <nb-card>
                        <nb-card-header>
                            Câu hỏi
                        </nb-card-header>
                        <nb-card-body>
                            <ckeditor [config]="ckConfig"
                                [(ngModel)]="selectedCauHoi.noiDungCauHoi"></ckeditor>
                        </nb-card-body>
                    </nb-card>
                    <nb-card>
                        <nb-card-header>
                            Câu trả lời
                            <button nbButton status="success" size="small" (click)="addCauTraLoi(selectedCauHoi)"
                                class="mr-1" style="float: right;height: 100%;">
                                <i class="fa fa-plus mr-2"></i>Thêm câu trả lời
                            </button>
                        </nb-card-header>
                        <nb-card-body *ngIf="selectedCauHoi.dapAns != null && selectedCauHoi.dapAns.length > 0" >
                            <cdk-virtual-scroll-viewport  style="height: 400px" itemSize="90" >
                                <nb-card>
                                    <nb-card-body>
                                        <div *ngFor="let dapAn of selectedCauHoi.dapAns; let i = index" class="mb-3">
                                            <nb-card>
                                                <nb-card-body>
                                                    <div class="mb-3">
                                                        <nb-checkbox [(ngModel)]="dapAn.isDapAnDung" status="info" style="float: right;">Đáp án đúng</nb-checkbox>
                                                        <span class="mr-2" style="font-weight: bold; font-size: 20px;">{{i + 1}}.</span>
                                                    </div>
                                                    <ckeditor [config]="ckConfig"
                                                        [(ngModel)]="dapAn.noiDungCauHoi"></ckeditor>
                                                    <div class="mt-3" style="text-align: right;">
                                                        <button nbButton status="danger" size="small"
                                                            (click)="removeCauTraLoi(dapAn)" class="mr-1"
                                                            style="height: 100%;">
                                                            <i class="fa fa-trash"></i>
                                                        </button>
                                                        <button nbButton status="success" size="small"
                                                            (click)="addCauTraLoi(selectedCauHoi)" class="mr-1"
                                                            style="height: 100%;">
                                                            <i class="fa fa-plus"></i>
                                                        </button>
                                                    </div>
                                                </nb-card-body>
                                            </nb-card>
                                        </div>
                                    </nb-card-body>
                                </nb-card>
                            </cdk-virtual-scroll-viewport>
                            
                        </nb-card-body>
                    </nb-card>
                </div>
            </div>
        </div>
    </nb-card-body>
    <nb-card-footer> 
        <button nbButton size="large" status="basic" class="float-left">
            <i class="fa fa-arrow-left mr-2"></i>Trở về
        </button>
        <button nbButton size="large" status="primary" (click)="saveListCauHoi()" class="float-right">
            <i class="fa fa-file mr-2"></i>Lưu đề thi
        </button>
    </nb-card-footer>
</nb-card>
